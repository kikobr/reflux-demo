var artemia=function(){var b={Interface:{storeType:"",storeName:"",useReduce:!1,isAvailable:function(){},get:function(){},remove:function(){},save:function(){},all:function(){},drop:function(){}}};b.interfaceIsImplemented=function(a){for(var f in b.Interface)if(b.Interface.hasOwnProperty(f))if(a[f]!=null){if(typeof b.Interface[f]!==typeof a[f])throw"artemia : "+a.storeType+" Storage : '"+f+"' ("+typeof a[f]+") : bad type";}else throw"artemia : "+a.storeType+" Storage : '"+f+"' method is missing";
};b.getStore=function(a){a=b["get_"+a.type.toUpperCase()+"_store"](a.base,a.type,a.domain);b.interfaceIsImplemented(a);a.query=function(f,a){var c=[],d;this.all(function(e){for(var i in e)e.hasOwnProperty(i)&&(d=f(e[i]))&&c.push(d);a&&a(c)});return this.useReduce?{sum:function(e){d=b.sum(c);e&&e(d);return d},min:function(e){d=b.min(c);e&&e(d);return d},max:function(e){d=b.max(c);e&&e(d);return d},product:function(e){d=b.product(c);e&&e(d);return d}}:null};return a};b.allDbs=function(){};b.guidGenerator=
function(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};b.sum=function(a){var f,b=0;for(f in a)a.hasOwnProperty(f)&&(b+=a[f]);return b};b.product=function(a){var f,b=1;for(f in a)a.hasOwnProperty(f)&&(b*=a[f]);return b};b.min=function(a){return Math.min.apply(Math,a)};b.max=function(a){return Math.max.apply(Math,a)};return b}();artemia=function(b){function a(a,g,c){return{storeType:c,storeName:g,useReduce:!0,isAvailable:function(){try{a.setItem("testKey","testValue"),a.removeItem("testKey")}catch(d){return!1}return!0},get:function(d,e){var c=JSON.parse(a.getItem(this.storeName+"|"+d));c?(c.key=d,e(c)):e(null)},remove:function(d,c){var b=this.storeName+"|"+(typeof d==="string"?d:d.key);a.removeItem(b);c&&c(b)},save:function(d,c){var i=this.storeName+"|"+(d.key||b.guidGenerator());delete d.key;a.setItem(i,JSON.stringify(d));
d.key=i.split("|")[1];c(d)},all:function(d){var c=[],b,k=a.length,h,j,g;for(b=0;b<k;b+=1)if(h=a.key(b),g=h.split("|")[0],j=h.split("|").slice(1).join("|"),g===this.storeName)h=JSON.parse(a.getItem(h)),h.key=j,c.push(h);d(c)},drop:function(c){var a=this;this.all(function(c){for(var d in c)c.hasOwnProperty(d)&&a.remove(c[d].key,null)});c&&c()}}}b.get_SESSION_store=function(b,g){var c=a(window.sessionStorage,b,g);c.isAvailable()||(c=null);return c};b.get_LOCAL_store=function(b,g){var c=a(window.localStorage,
b,g);c.isAvailable()||(c=null);return c};b.get_GLOBAL_store=function(b,g,c){b=a(window.globalStorage[c],b,g);b.isAvailable()||(b=null);return b};return b}(artemia);artemia=function(b){function a(a,g){return{storeType:g,storeName:a,dataBase:null,useReduce:!1,isAvailable:function(){try{var c=this;artemia[a]||(artemia[a]=window.openDatabase("Artemia","1.0","ARTEMIADB",65536));this.dataBase=artemia[a];this.dataBase.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS  "+c.storeName+"(UniqueId TEXT UNIQUE PRIMARY KEY,SerializedObject TEXT)",[],null,null)})}catch(d){if(d===2)throw"Invalid database version";else throw"Unknown error "+d;}return!0},save:function(a,
d){var e,f,g=this;e=function(a,c){g.dataBase.transaction(function(d){d.executeSql("UPDATE "+g.storeName+" SET SerializedObject = ? WHERE UniqueId = ?;",[JSON.stringify(a),a.key],c(a),null)})};f=function(a,c){g.dataBase.transaction(function(d){if(!a.key)a.key=b.guidGenerator();d.executeSql("INSERT INTO "+g.storeName+" (UniqueId, SerializedObject) VALUES (?, ?);",[a.key,JSON.stringify(a)],c(a),null)})};a.key===void 0?f(a,d):this.get(a.key,function(b){b===null?f(a,d):e(a,d)})},get:function(a,d){var b=
this;b.dataBase.transaction(function(f){f.executeSql("SELECT SerializedObject FROM "+b.storeName+" WHERE UniqueId= ?;",[a],function(a,b){var c={},c=b.rows.length>0?JSON.parse(b.rows.item(0).SerializedObject):null;d(c)},function(){})})},remove:function(a,b){var e=this;e.dataBase.transaction(function(f){var g=typeof a==="string"?a:a.key;f.executeSql("DELETE FROM "+e.storeName+" WHERE UniqueId= ?;",[g],function(){b(g)},function(){})})},all:function(a){var b=this;b.dataBase.transaction(function(e){e.executeSql("SELECT * FROM "+
b.storeName+";",[],function(b,d){var e=[],f={},g;for(g=d.rows.length;g--;)f=d.rows.item(g),f=JSON.parse(f.SerializedObject),e.push(f);a(e)},function(){})})},nuke:function(a){var b=this;b.dataBase.transaction(function(e){e.executeSql("DELETE FROM "+b.storeName+";",[],function(){a()},function(){})})},drop:function(a){var b=this;b.dataBase.transaction(function(e){e.executeSql("DROP TABLE "+b.storeName+";",[],function(){a()},function(){})})}}}b.get_SQLITE_store=function(b,g){var c=a(b,g);c.isAvailable()||
(c=null);return c};return b}(artemia);